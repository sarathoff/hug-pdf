services:
  # Backend Web Service — uses Docker to support LaTeX (texlive) system dependencies
  - type: web
    name: hugpdf-backend
    runtime: docker
    region: oregon
    plan: starter # $7/mo — 512MB RAM. Upgrade to 'standard' ($25) if you hit memory issues during LaTeX compile
    branch: main
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    envVars:
      - key: GEMINI_API_KEY
        sync: false
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_KEY
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: SUPABASE_JWT_SECRET
        sync: false
      - key: DODO_PAYMENTS_API_KEY
        sync: false
      - key: DODO_PAYMENTS_PUBLIC_KEY
        sync: false
      - key: DODO_PAYMENTS_WEBHOOK_KEY
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGINS
        sync: false
      - key: PAYMENT_TEST_MODE
        value: "false"
    healthCheckPath: /api/
